<Project>

  <!-- Authenticode signing -->
  <Target Name="SignAuthenticode" AfterTargets="AfterBuild" Condition="'$(SignAuthenticode)' == 'true' and '$(MSBuildProjectExtension)' == '.csproj'">
    <SignFile CertificateThumbprint="$(SignAuthenticodeThumbprint)" TimestampUrl="$(SignAuthenticodeTimestamp)" SigningTarget="$(TargetPath)" />
  </Target>

  <!-- Authenticode signing for WiX -->
  <Target Name="SignMsi">
    <Exec Command= "&quot;$(SignToolPath)&quot; $(SignToolArguments) %(SignMsi.FullPath)" />
  </Target>
</Project>